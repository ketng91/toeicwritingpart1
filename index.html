<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TOEIC Writing - Part 1 Photo</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
body {
  font-family: Arial, sans-serif;
  background-color: #fff8f0;
  margin: 0;
  padding: 0;
  text-align: center;
}
header {
  background-color: #ffd6ba;
  padding: 15px 20px;
  font-weight: bold;
  color: #7a4e3e;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
}
.header-left { position: absolute; left: 20px; }
.header-left a {
  display: flex; align-items: center; gap: 8px;
  font-size: 18px; color: #7a4e3e; text-decoration: none;
}
.header-center { font-size: 22px; font-weight: bold; }
.top-select { display: flex; justify-content: flex-start; margin: 20px; width: 100%; }
select {
  padding: 8px 14px; font-size: 18px;
  border-radius: 8px; border: 2px solid #a0e7e5;
  background-color: #e3fdfd;
}




/* TIMER */
#timerBox { margin: -10px auto 5px auto; font-size: 24px; text-align: center; }
#timerBox button {
  margin-left: 10px; padding: 6px 12px; font-size: 18px;
  border-radius: 8px; border: none; cursor: pointer; background-color: #a0e7e5;
}
#timerBox button:hover { background-color: #ffb3ba; }

/* MAIN CONTAINER */
.exercise {
  width: 90%;
  margin: 20px auto;
  font-size: 20px;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 25px;
}
.pic-side, .write-side {
  background-color: #e3fdfd;
  border-radius: 10px;
  padding: 10px;
  border: 2px solid #a0e7e5;
}
.pic-side { width: 380px; }
.write-side { width: 420px; }
.pic {
  width: 100%; height: 230px;
  background-color: #ddd;
  border-radius: 8px;
}
.pic img {
  width: 100%; height: 100%; border-radius: 8px; object-fit: cover;
}
.keywords {
  font-size: 23px;
  margin-top: 10px;
  padding: 6px;
  background: #fff;
  border-radius: 6px;
}
textarea {
  width: 95%;
  height: 160px;
  font-size: 22px;
  color: #F63049;
  font-family: "Arial", sans-serif;
  border-radius: 8px;
  padding: 10px;
  resize: vertical;
  border: 2px solid #a0e7e5;
}
.exercise-buttons { margin: 20px; }
.exercise-buttons button {
  padding: 10px 18px; font-size: 20px;
  border-radius: 8px; border: none; margin-right: 15px;
  cursor: pointer; background-color: #a0e7e5;
}
.exercise-buttons button:hover { background-color: #ffb3ba; }
.result { font-weight: bold; font-size: 22px; margin-top: 10px; }
footer { margin-top: 25px; }


/* NÃºt chung */
.exercise-buttons button {
  padding: 10px 18px; font-size: 20px;
  border-radius: 8px; border: none; margin-right: 15px;
  cursor: pointer;
}

/* MÃ u riÃªng tá»«ng nÃºt */
.exercise-buttons button:nth-child(1) { background-color: #a0e7e5; }  /* Back */
.exercise-buttons button:nth-child(3) { background-color: #a0e7e5; }  /* Next */

/* Check nÃºt xanh lÃ¡ */
.exercise-buttons button:nth-child(2) {
  background-color: #32CD32;
  color: white;
}
.exercise-buttons button:nth-child(2):hover {
  background-color: #28a428;
}

/* Submit nÃºt xanh dÆ°Æ¡ng */
.exercise-buttons button:nth-child(4) {
  background-color: #1E90FF;
  color: white;
}
.exercise-buttons button:nth-child(4):hover {
  background-color: #187bdb;
}




</style>
</head>

<body>
<header>
  <div class="header-left">
    <a href="https://ketng91.github.io/lopanhthayket/">
      <i class="fa-solid fa-house"></i> Lá»›p Anh tháº§y Káº¿t
    </a>
  </div>
  <div class="header-center">TOEIC Writing Part 1</div>
</header>

<div class="top-select">
  <select id="exerciseList">
    <option value="1">Test 1</option>
    <option value="2">Test 2</option>
    <option value="3">Test 3</option>
    <option value="4">Test 4</option>
    <option value="5">Test 5</option>


  </select>
</div>

<div id="timerBox">
  <span id="timer">08:00</span>
  <button onclick="startTimer()">Start</button>
  <button onclick="resetTimer()">Reset</button>
</div>

<div class="exercise">
  <div class="pic-side">
    <div class="pic"><img id="picDisplay" src=""></div>
    <div class="keywords" id="keywordBox">keyword1, keyword2</div>
  </div>

  <div class="write-side">
    <textarea id="answerBox" placeholder="Write your sentence..."></textarea>
  </div>
</div>

<div class="exercise-buttons">
  <button onclick="prevPic()">Back</button>
  <button onclick="checkAnswer()">Check</button>
  <button onclick="nextPic()">Next</button>
  <button onclick="submitAnswers()">Submit</button>
</div>

<div class="result" id="result"></div>

<footer>ChÄƒm chá»‰ thÃ¬ Ä‘áº­u!</footer>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<script>
// ===== PHOTO DATA =====
const tests = {
  1: [
    { img: "T1image1.jpg", keys:["park","bench"], answer:"A woman is sitting on a bench in the park." },
    { img: "T1image2.jpg", keys:["in","computer"], answer:"A man is typing at his computer in an office." },
    { img: "T1image3.jpg", keys:["street","cross"], answer:"Several people are crossing the street." },
    { img: "T1image4.jpg", keys:["outdoor","fruit"], answer:"Vendors are selling fruit in an outdoor market." },
    { img: "T1image5.jpg", keys:["where","food"], answer:"The waiter is carrying a plate of food to the table where two women are sitting." }
  ],
  2: [
    { img: "T2image1.jpg", keys:["grass","in"], answer:"People are sitting on the grass in the park." },
    { img: "T2image2.png", keys:["present","colleague"], answer:"A woman is presenting her report to colleagues in the meeting room." },
    { img: "T2image3.png", keys:["parents","child"], answer:"The parents are hanging a picture on the wall, while their child is standing by the table." },
    { img: "T2image4.png", keys:["backpack","hand"], answer:"Two elderly people, holding hands and carrying backpacks, walk down the road." },
    { img: "T2image5.png", keys:["while","store"], answer:"Three women, holding shopping bags, are window shopping in front of a store." }
  ],
  3: [
    { img: "T3image1.png", keys:["line","because"], answer:"People are standing in a line to get their food because they are in a cafeteria." },
    { img: "T3image2.jpg", keys:["while","shelf"], answer:"The man is reading a book while he is standing between the storage shelves." },
    { img: "T3image3.jpg", keys:["park","and"], answer:"Many cars are parked in rows and there are many green trees in the background." },
    { img: "T3image4.jpg", keys:["phone","across"], answer:"A businessman is looking at his phone while walking across the street." },
    { img: "T3image5.jpg", keys:["laugh","with"], answer:"They are laughing while working at a desk with a laptop." }
  ],
  4: [
    { img: "T4image1.jpg", keys:["there","on"], answer:"There is a tissue box and fresh lemons on the table." },
    { img: "T4image2.jpg", keys:["counter","while"], answer:"The customers are waiting at the wooden counter while the barista is preparing a drink." },
    { img: "T4image3.jpg", keys:["park","and"], answer:"Many cars are parked in rows and there are many green trees in the background." },
    { img: "T4image4.jpg", keys:["cups","because"], answer:"A few people are holding cups because they are having a break." },
    { img: "T4image5.jpg", keys:["plant","environment"], answer:"The volunteers are planting young trees because they want to protect the environment." }
  ],
  5: [
    { img: "T5image1.jpg", keys:["display","because"], answer:"Several pictures are displayed on the wall because this is an art gallery." },
    { img: "T5image2.jpg", keys:["order","table"], answer:"The waitress is taking an order from the customers at the table." },
    { img: "T5image3.jpeg", keys:["stand","boats"], answer:"Many people are standing on the pier, and there are several boats in the background." },
    { img: "T5image4.jpg", keys:["run","along"], answer:"The man and the woman are running along the path." },
    { img: "T5image5.jpg", keys:["coffee","next to"], answer:"The smiling woman is holding a cup of coffee and she is sitting next to a green plant." }
  ],


};

let currentTest = 1;
let index = 0;

// NEW: lÆ°u cÃ¢u cho má»—i tranh
let studentAnswers = ["", "", "", "", ""];

// Khi Ä‘á»•i test
document.getElementById("exerciseList").addEventListener("change", e=>{
  currentTest = e.target.value;
  index = 0;
  studentAnswers = ["", "", "", "", ""]; 
  loadPic();
});

// Load tranh
function loadPic(){
  const picData = tests[currentTest][index];
  document.getElementById("picDisplay").src = picData.img;
  document.getElementById("keywordBox").innerText = picData.keys.join(", ");

  // Load láº¡i cÃ¢u Ä‘Ã£ nháº­p
  document.getElementById("answerBox").value = studentAnswers[index];
  document.getElementById("result").innerText = "";
}

// Next
function nextPic(){
  studentAnswers[index] = document.getElementById("answerBox").value;
  if(index < tests[currentTest].length-1){
    index++;
    loadPic();
  }
}
// Back
function prevPic(){
  studentAnswers[index] = document.getElementById("answerBox").value;
  if(index > 0){
    index--;
    loadPic();
  }
}

// Check
function checkAnswer(){
  let user = document.getElementById("answerBox").value.trim().toLowerCase();
  let correct = tests[currentTest][index].answer.toLowerCase();
  let resultBox = document.getElementById("result");

  // Náº¿u trá»‘ng
  if(user.length === 0){
    resultBox.style.color = "red";
    resultBox.innerText = "âŒ Please write your sentence!";
    return;
  }

  // So khá»›p Ä‘Æ¡n giáº£n: pháº£i chá»©a 3 tá»« Ä‘áº§u tiÃªn
  let keyMatch = correct.split(" ").slice(0,3).every(w => user.includes(w));

  if(keyMatch){
    resultBox.style.color = "green";
    resultBox.innerText = "âœ” Correct!";
    confetti({particleCount:100, spread:80});
  } else {
    resultBox.style.color = "red";
    resultBox.innerHTML = `ðŸ‘‰ Sample answer:<br>${tests[currentTest][index].answer}`;
  }
}

// Submit táº£i txt
function submitAnswers(){
  studentAnswers[index] = document.getElementById("answerBox").value;

  let text = "";
  studentAnswers.forEach((ans,i)=>{
    text += `Picture ${i+1}:\n${ans}\n\n`;
  });

  const blob = new Blob([text], {type:"text/plain"});
  const url = URL.createObjectURL(blob);

  const link = document.createElement("a");
  link.href = url;
  link.download = "TOEIC_Writing_Answers.txt";
  link.click();

  URL.revokeObjectURL(url);
}

// TIMER = 8:00
let timerInterval;
let remaining = 480;

function startTimer(){
  clearInterval(timerInterval);
  timerInterval=setInterval(()=>{
    remaining--;
    if(remaining<=0){clearInterval(timerInterval);}
    updateTimer();
  },1000);
}
function resetTimer(){
  clearInterval(timerInterval);
  remaining=480;
  updateTimer();
}
function updateTimer(){
  let m=Math.floor(remaining/60);
  let s=remaining%60;
  document.getElementById("timer").innerText=(m<10?"0":"")+m+":"+(s<10?"0":"")+s;
}

loadPic();
updateTimer();
</script>
</body>
</html>
